<template>    <div>        <div class="show-con">            <el-form inline :model="search">                <el-form-item label="所属分类">                    <el-select v-model="search.cname" filterable clearable placeholder="请选择">                        <el-option                                v-for="item in category"                                :key="item.cid"                                :value="item.cname"                                :label="item.cname"                        ></el-option>                    </el-select>                </el-form-item>                <el-form-item label="民俗名称">                    <el-input v-model="search.hname"></el-input>                </el-form-item>                <el-form-item label="民宿城市">                    <el-input v-model="search.hcity"></el-input>                </el-form-item>                <el-button type="primary" @click="searchHomestay">搜索</el-button>            </el-form>            <!--            <h1>{{this.msg | capitalize(3)}}</h1>-->            <div class="table-con">                <el-table :data="homestay"                          border                          v-loading="loading"                          element-loading-text="拼死加载中"                          element-loading-spinner="el-icon-loading"                >                    <el-table-column prop="hid" label="ID" width="80px" align="center"></el-table-column>                    <el-table-column prop="hname" label="民宿名称"></el-table-column>                    <el-table-column prop="cname" label="所在分类" width="80px"></el-table-column>                    <el-table-column label="民宿位置" width="170px">                        <template slot-scope="scope">                            <span>{{scope.row.hprovince}}-{{scope.row.hcity}}-{{scope.row.harea}}</span>                        </template>                    </el-table-column>                    <el-table-column label="民宿价格" width="80px" align="center">                        <template slot-scope="scope">                            <span> {{scope.row.hprice| moneyformate}}</span>                        </template>                    </el-table-column>                    <el-table-column label="标签">                        <template slot-scope="scope">                            <el-button v-for="(key1,index) in  scope.row.htag.split(/,|，/)" :key="index">{{key1}}                            </el-button>                        </template>                    </el-table-column>                    <el-table-column label="民宿状态" width="80px" align="center">                        <template slot-scope="scope">                            <span>{{scope.row.hstatus==1?'可预订':'满'}}</span>                        </template>                    </el-table-column>                    <el-table-column label="创建时间" width="120px">                        <template slot-scope="scope">                            <span>{{scope.row.htime | formateTime}}</span>                        </template>                    </el-table-column>                    <el-table-column label="操作" align="center">                        <template slot-scope="scope">                            <el-button type="primary">查看</el-button>                            <el-button type="warning">                                <router-link :to="{name:'edithomestay',params:{hid:scope.row.hid}}">编辑</router-link>                            </el-button>                            <el-button type="danger" @click="delHomestay(scope.row.hid,scope.row.hname)">删除</el-button>                        </template>                    </el-table-column>                </el-table>                <div class="paginate">                    <el-pagination                            background                            :total="total"                            :page-size.sync="paginate.limit"                            :current-page.sync="paginate.page"                            layout="total, prev, pager, next, jumper"                            @current-change="handleCurrentChange"                    >                    </el-pagination>                </div>            </div>        </div>    </div></template><script>    import instance from "../../../http/http";    import {SUCCESS} from "../../../lib/base";    export default {        name: "homestayIndex",        data() {            return {                msg: 'hello boy!',                search: {hname: '', hcity: '', cname: ''},                paginate: {                    limit: 7,                    page: 1                },                homestay: [],                total: 0,                loading: false,                category: []            }        },        methods: {            initHomestayForm() {                this.loading = true;                let params = Object.assign({}, this.search, this.paginate);                instance.get('/api/Homestay', {params}).then(res => {                    if (res.code === SUCCESS) {                        //let data = res.data;                        // data = data.map(ele=>{                        //     ele.htag = ele.htag.split(/,|，/);                        //     //过滤器 对文本进行格式化                        //     // let date = new Date(ele.htime*1000);                        //     // ele.htime = [date.getFullYear(),date.getMonth()+1,date.getDate()].join('-');                        //     return ele;                        // })                        this.homestay = res.data;                        this.total = res.total;                        // this.$notify({                        //     title:'提示',                        //     type:'success',                        //     message:res.msg,                        //     showClose:false                        // })                        setTimeout(() => {                            this.loading = false;                        }, 200)                    } else {                        this.$notify({                            title:'提示',                            type:'warning',                            message:'暂无数据',                            duration:0                        })                        this.homestay = [];                        setTimeout(() => {                            this.loading = false;                        }, 200)                    }                }).catch(() => {                })            },            initCategory() {                instance.post('/admin/Category/showCategoryAll').then(res => {                    //console.log(res);                    if (res.code === SUCCESS) {                        this.category = res.data;                    } else {                        this.$message.error(res.msg);                    }                }).catch(() => {                });            },            //查找按钮            searchHomestay() {                this.paginate.page = 1;                this.initHomestayForm();            },            handleCurrentChange(val) {                this.paginate.page = val;                this.initHomestayForm();            },            delHomestay(cid, hname) {                console.log(cid);                this.$confirm('你确定要删除民宿--' + hname + '--吗?', '提示', {                    confirmButtonText: '确定',                    cancelButtonText: '取消',                    type: 'warning'                }).then(() => {                    instance.delete('/api/Homestay/' + cid).then((res) => {                        console.log(res);                        if (res.code === SUCCESS) {                            this.$notify({                                title: '提示',                                type: 'success',                                message: res.msg,                                showClose: false                            });                            this.initHomestayForm();                        } else {                            this.$notify({                                title: '提示',                                type: 'error',                                message: res.msg,                                duration: 0                            });                        }                    }).catch(() => {                    })                }).catch(() => {                    this.$message({                        type: 'info',                        message: '已取消删除'                    })                })            }        },        //局部过滤器 过滤器可以接收参数        filters: {            // capitalize(value,position){            //     return value.substring(0,position).toUpperCase()+value.substring(1);            // },            // formateTime(value){            //     let date = new Date(value*1000);            //     value = [date.getFullYear(),date.getMonth()+1,date.getDate()].join('-');            //     return value;            // }        },        mounted() {            this.initHomestayForm();            this.initCategory();        }    }</script><style scoped>    .show-con {        padding: 40px 20px;        height: 100%;        box-sizing: border-box;        background-color: #F5FAFF;    }    /*.el-table{*/    /*    border: 1px solid black;*/    /*}*/    /*.el-table td{*/    /*    border: 1px solid black;*/    /*}*/    .paginate {        width: 100%;        height: auto;        text-align: center;        margin-top: 15px;    }    .table-con {        height: auto;        padding: 10px;        background-color: white;        /*//position: relative;*/        border-radius: 3px;        border-top: none;        border: 1px solid #f5f5f5;        box-shadow: 3px 2px 5px 2px #e4e3e3;        border-bottom-left-radius: 7px;        border-bottom-right-radius: 7px;        color: #828282;        box-sizing: border-box;        margin-top: 20px;        margin-bottom: 60px;        /*animation: myfirst 1.5s ease-in-out 0ms ;*/        /*-webkit-animation: myfirst 1.5s ease-in-out 0ms;*/        /*-o-animation: myfirst 1.5s ease-in-out 0ms ;*/        /*-moz-animation:  myfirst 1.5s ease-in-out 0ms;*/    }</style>